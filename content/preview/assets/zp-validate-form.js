/* 
 * ZP Form Validation
 * Copyright $Date:: 2014#$ Zeta Software GmbH
 */
$z(document).ready(function(){function a(e){var b=["date","time","color"];var c=$z(e).attr("type");if(b.indexOf(c)!==-1){var d=document.createElement("input");d.setAttribute("type",c);if(d.type!=="text"){return false}}if($z(e).attr("placeholder")!==""&&$z(e).attr("placeholder")!==undefined){return true}return false}new zp.Templating().init();$z("form.zp-form").each(function(){var b="#"+$z(this).attr("id");$z(this).submit(function(c){zpValidateForm(b,c)})});$z(".zp-form input.asfield").css("display","none");if($z.support.placeholder){$z(".zp-form input:text, .zp-form .typetext, .zp-form textarea").each(function(){if(a($z(this))){$z(".zp-form label[for='"+$z(this).attr("id")+"']").css({height:"0px",overflow:"hidden",opacity:"0"})}})}$z("#recaptcha_table").css({border:"1px solid #dfdfdf !important","background-color":"#ffffff"});$z("#recaptcha_table").attr("title","Um sicherzustellen, dass dieser Formularservice nicht missbräuchlich verwendet wird, geben Sie bitte die 2 Wörter im Feld unten ein.")});zp.Templating=function(){var a=this;var b;this.init=function(){var d,e=/\+/g,g=/([^&=]+)=?([^&]*)/g,c=function(h){return decodeURIComponent(h.replace(e," "))},f=window.location.search.substring(1);b={};while(d=g.exec(f)){b[c(d[1])]=c(d[2])}a.doTemplate()};this.doTemplate=function(){$z("form input[value*='{@'], form textarea:contains('{@')").each(function(){var d=/({\@([^}]+)})/g;while(match=d.exec($z(this).val())){var c=new RegExp(match[1],"gi");if(b[match[2]]){$z(this).val($z(this).val().replace(c,b[match[2]]))}else{c=new RegExp(match[1]+"\\s*","gi");$z(this).val($z(this).val().replace(c,""))}}})}};function zpValidateForm(h,d){var g=[];var f="";var k=true;var i=$z("form"+h+" input[name='f_invalidEmailMsg']").val();if(!i){i="keine gültige E-Mail"}function j(e){var m=/^[_a-z0-9-+]+(\.[_a-z0-9-+]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,63})$/i;return m.test(e)}function l(m,n){if($z("form"+m+" *[name='F"+n+"']").length===0){$z("form"+m+" label[for='F"+n+"']").css("color","");$z("form"+m+" label[for='F"+n+"']").css("text-shadow","");if($z("form"+m+" input:checkbox[name='F"+n+"[]']").length&&$z("form"+m+" input:checkbox[name='F"+n+"[]']:checked").val()===undefined){f+=$z("form"+m+" #NAME"+n).val()+", ";k=false;$z("form"+m+" label[for='F"+n+"']").css("color","red");$z("form"+m+" label[for='F"+n+"']").css("text-shadow","1px 1px 0 #ffffff")}if($z("form"+m+" select[name='F"+n+"[]']").length&&!$z("form"+m+" select[name='F"+n+"[]']").val()){f+=$z("form"+m+" #NAME"+n).val()+", ";k=false;$z("form"+m+" label[for='F"+n+"']").css("color","red");$z("form"+m+" label[for='F"+n+"']").css("text-shadow","1px 1px 0 #ffffff")}}else{if(($z("form"+m+" *[name='F"+n+"']").attr("type")!=="radio"&&$z("form"+m+" *[name='F"+n+"']").val()==="")||($z("form"+m+" *[name='F"+n+"']").attr("type")=="email"&&!j($z("form"+m+" *[name='F"+n+"']").val()))||($z("form"+m+" *[name='F"+n+"']").attr("type")=="radio"&&$z("form"+m+" input:radio[name='F"+n+"']").filter(":checked").val()===undefined)){var e=["text","number","email","tel","url","date","time","color","search"];if(e.indexOf($z("form"+m+" #F"+n).attr("type"))!==-1||$z("form"+m+" #F"+n).is("textarea")){g.push($z("form"+m+" #F"+n))}if($z("form"+m+" #F"+n).attr("type")=="email"&&$z("form"+m+" *[name='F"+n+"']").val()!==""){f+=$z("form"+m+" #NAME"+n).val()+" ("+i+"), "}else{f+=$z("form"+m+" #NAME"+n).val()+", "}k=false;$z("form"+m+" label[for='F"+n+"']").css("color","red");$z("form"+m+" label[for='F"+n+"']").css("text-shadow","1px 1px 0 #ffffff");$z("form"+m+" #F"+n).css("border","1px solid red")}else{$z("form"+m+" label[for='F"+n+"']").css("color","");$z("form"+m+" label[for='F"+n+"']").css("text-shadow","");$z("form"+m+" #F"+n).css("border","")}}}$z("form"+h+" .required").each(function(){var e=$z(this).attr("name");e=e.replace("F","").replace("[]","");l(h,e)});$z("form"+h+" input[type=email]:not(.required)").each(function(){if($z(this).val()!==""){var e=$z(this).attr("name");e=e.replace("F","").replace("[]","");l(h,e)}});if($z("#recaptcha_challenge_field").length>0){$z.ajaxSetup({error:function(m,e){if(m.status===0){alert("Not connected. Please verify your network.")}else{if(m.status==404){alert("ERROR: Requested page not found. [404]")}else{if(m.status==500){alert("ERROR: Internal Server Error [500].")}else{if(e==="parsererror"){alert("ERROR: Requested JSON parse failed.")}else{if(e==="timeout"){alert("ERROR: Time out error.")}else{if(e==="abort"){alert("ERROR: Ajax request aborted.")}else{alert("ERROR: Uncaught Error."+m.responseText)}}}}}}},async:false});var a=$z("form"+h).attr("action");$z.post(a,{verifycaptcha:"yes",recaptcha_challenge_field:$z("#recaptcha_challenge_field").val(),recaptcha_response_field:$z("#recaptcha_response_field").val()},function(e){if(e!=="OK"){console.log(e);k=false;f+=$z("form"+h+" #recaptchalabel").text()+", ";$z("form"+h+" #recaptchalabel").css("color","red");$z("form"+h+" #recaptchalabel").css("text-shadow","1px 1px 0 #ffffff");$z("form"+h+" #recaptcha_table").attr("style","border: 1px solid red !important")}else{$z("form"+h+" #recaptchalabel").css("color","");$z("form"+h+" #recaptchalabel").css("text-shadow","");$z("form"+h+" #recaptcha_table").removeAttr("style")}})}if($z(".g-recaptcha").length>0){var c=grecaptcha.getResponse();if(c.length===0){f+=$z("form"+h+" #recaptchalabel").text()+", ";$z("form"+h+" #recaptchalabel").css("color","red");$z("form"+h+" #recaptchalabel").css("text-shadow","1px 1px 0 #ffffff");$z("form"+h+" .g-recaptcha").css("border","1px solid red").css("width","304px")}else{$z("form"+h+" #recaptchalabel").css("color","");$z("form"+h+" #recaptchalabel").css("text-shadow","");$z("form"+h+" .g-recaptcha").css("border","").css("width","")}}f=f.substr(0,f.length-2);if(f!==""){var b=$z("form"+h+" input[name='f_alertPrefix']").val();if(!b){b="Bitte füllen Sie die rot markierten Felder aus:"}$z("form"+h+" .formvalidateerror").remove();$z("form"+h).prepend('<div class="formvalidateerror" style="color: #fff; background-color: red; padding: 6px 12px;"><p>'+b+"<br/><strong>"+f+"</strong></p></div>");$z("html, body").animate({scrollTop:$z("form"+h+" .formvalidateerror").first().offset().top-parseInt($z("body").css("padding-top"))},500);$z(g[0]).focus()}if(!k){d.preventDefault()}return k};